% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\author{}
\date{\vspace{-2.5em}}

\begin{document}

library(data.table) library(ggplot2) library(stringr)

setwd(``C:/Users/Frank/Desktop/GitHub/project\_bacteria/'')

load(``database/uniprot/esmc50\_domain.RData'')
load(``database/uniprot/host\_bacteria\_pfam\_ddi2species.RData'')

\hypertarget{experimental-evidence-that-pathogens-target-host-domains-involved-in-host-specific-processes}{%
\subsubsection{Experimental evidence that pathogens target host domains
involved in host-specific
processes}\label{experimental-evidence-that-pathogens-target-host-domains-involved-in-host-specific-processes}}

div\_evol = data.table(Domain = ddi\_bh{[}dmB \%in\%
pfam2proteome\_host\$pfam, sort(intersect(dmB, pfam\_ppi\_hh)){]})
div\_evol{[}, ddi\_hh\_exc := paste0(sort(setdiff(ddi\_hh{[}dmA \%in\%
Domain \textbar{} dmB \%in\% Domain, paste(dmA, dmB, sep = "\_"){]},
ddi\_bb{[}dmA \%in\% Domain \textbar{} dmB \%in\% Domain, paste(dmA,
dmB, sep = "\_"){]})), collapse = ``;''), by = ``Domain''{]}
div\_evol{[}, ddi\_hh\_bb := paste0(sort(intersect(ddi\_hh{[}dmA \%in\%
Domain \textbar{} dmB \%in\% Domain, paste(dmA, dmB, sep = "\_"){]},
ddi\_bb{[}dmA \%in\% Domain \textbar{} dmB \%in\% Domain, paste(dmA,
dmB, sep = "\_"){]})), collapse = ``;''), by = ``Domain''{]}
div\_evol{[}, num\_ddi\_hh\_exc := ifelse(nchar(ddi\_hh\_exc) == 0, 0,
str\_count(ddi\_hh\_exc, ``;'') + 1), by = ``Domain''{]} div\_evol{[},
num\_ddi\_hh\_bb := ifelse(nchar(ddi\_hh\_bb) == 0, 0,
str\_count(ddi\_hh\_bb, ``;'') + 1), by = ``Domain''{]} div\_evol{[},
eukexc := num\_ddi\_hh\_bb == 0{]} div\_evol{[}, euk2bac :=
(num\_ddi\_hh\_exc + 0.001) / (num\_ddi\_hh\_bb + 0.001){]}
setorder(div\_evol, -eukexc, -euk2bac) div\_evol = div\_evol{[},
.(Domain, ddi\_hh\_exc, ddi\_hh\_bb, num\_ddi\_hh\_exc,
num\_ddi\_hh\_bb){]} div\_evol{[}, baceuk\_ppi :=
ddi\_bh{[}match(Domain, dmB), paste0(paste(cidA, cidB, sep = "\_``),''
(``, pmid,'')"){]}{]} div\_evol{[}, baceuk\_ppi := gsub(``pubmed:'', "",
baceuk\_ppi){]} setnames(div\_evol, c(``Horizontally-acquired host
domain'', ``DDIs mapped to eukaryote-endogenous PPIs'', ``DDIs mapped to
eukaryote-endogenous and bacteria-endogenous PPIs'', ``\# DDIs mapped to
eukaryote-endogenous PPIs'', ``\# DDIs mapped to eukaryote-endogenous
and bacteria-endogenous PPIs'', ``Host-pathogen PPIs (PMIDs)''))
write.csv(div\_evol, ``figs\_tabs/Supplementary Table 1.csv'', quote =
FALSE, row.names = FALSE)

conv\_evol = data.table(Domain = ddi\_bh{[}!dmB \%in\%
pfam2proteome\_host\$pfam, sort(intersect(dmA, pfam\_ppi\_hh)){]})
conv\_evol{[}, ddi\_hh\_exc := paste0(sort(setdiff(ddi\_hh{[}dmA \%in\%
Domain \textbar{} dmB \%in\% Domain, paste(dmA, dmB, sep = "\_"){]},
ddi\_bb{[}dmA \%in\% Domain \textbar{} dmB \%in\% Domain, paste(dmA,
dmB, sep = "\_"){]})), collapse = ``;''), by = ``Domain''{]}
conv\_evol{[}, ddi\_hh\_bb := paste0(sort(intersect(ddi\_hh{[}dmA \%in\%
Domain \textbar{} dmB \%in\% Domain, paste(dmA, dmB, sep = "\_"){]},
ddi\_bb{[}dmA \%in\% Domain \textbar{} dmB \%in\% Domain, paste(dmA,
dmB, sep = "\_"){]})), collapse = ``;''), by = ``Domain''{]}
conv\_evol{[}, num\_ddi\_hh\_exc := ifelse(nchar(ddi\_hh\_exc) == 0, 0,
str\_count(ddi\_hh\_exc, ``;'') + 1), by = ``Domain''{]} conv\_evol{[},
num\_ddi\_hh\_bb := ifelse(nchar(ddi\_hh\_bb) == 0, 0,
str\_count(ddi\_hh\_bb, ``;'') + 1), by = ``Domain''{]} conv\_evol{[},
eukexc := num\_ddi\_hh\_bb == 0{]} conv\_evol{[}, euk2bac :=
(num\_ddi\_hh\_exc + 0.001) / (num\_ddi\_hh\_bb + 0.001){]}
setorder(conv\_evol, -eukexc, -euk2bac) conv\_evol = conv\_evol{[},
.(Domain, ddi\_hh\_exc, ddi\_hh\_bb, num\_ddi\_hh\_exc,
num\_ddi\_hh\_bb){]} conv\_evol{[}, baceuk\_ppi :=
ddi\_bh{[}match(Domain, dmA), paste0(paste(cidA, cidB, sep = "\_``),''
(``, pmid,'')"){]}{]} conv\_evol{[}, baceuk\_ppi := gsub(``pubmed:'',
"", baceuk\_ppi){]} setnames(conv\_evol, c(``Convergently-targeted host
domain'', ``DDIs mapped to eukaryote-endogenous PPIs'', ``DDIs mapped to
eukaryote-endogenous and bacteria-endogenous PPIs'', ``\# DDIs mapped to
eukaryote-endogenous PPIs'', ``\# DDIs mapped to eukaryote-endogenous
and bacteria-endogenous PPIs'', ``Host-pathogen PPIs (PMIDs)''))
write.csv(conv\_evol, ``figs\_tabs/Supplementary Table 2.csv'', quote =
FALSE, row.names = FALSE)

\hypertarget{interacting-eukaryotic-domains}{%
\subsubsection{Interacting eukaryotic
domains}\label{interacting-eukaryotic-domains}}

\hypertarget{bacterial-protein-contains-eukaryotic-domain}{%
\section{bacterial protein contains eukaryotic
domain}\label{bacterial-protein-contains-eukaryotic-domain}}

esmc50\_domain{[}, N\_hom := sum(unlist(strsplit(pfam, ``;'')) \%in\%
pfam2proteome\_host\$pfam), by = ``uniprotid''{]} \# eukaryotic domain
mediates DDIs in eukaryotes esmc50\_domain{[}, N\_hom\_ddi\_hh :=
sum(unlist(strsplit(pfam, ``;'')) \%in\% pfam\_ppi\_hh), by =
``uniprotid''{]} \# eukaryotic domain mediates DDIs in eukaryotes only
pfam\_ppi\_hh\_exc = setdiff(pfam\_ppi\_hh, c(pfam\_ppi\_bb,
pfam\_pdb\_bb\_all)) esmc50\_domain{[}, N\_hom\_ddi\_hh\_exc :=
sum(unlist(strsplit(pfam, ``;'')) \%in\% pfam\_ppi\_hh\_exc), by =
``uniprotid''{]} esmc50\_domain{[}, pfam\_hom\_ddi\_hh\_exc :=
paste0(intersect(unlist(strsplit(pfam, ``;'')), pfam\_ppi\_hh\_exc),
collapse = ``;''), by = ``uniprotid''{]}

esmc50\_domain{[}, table(N\_hom == 0), by = ``type''{]}
esmc50\_domain{[}N\_hom \textgreater{} 0, table(N\_hom\_ddi\_hh == 0),
by = ``type''{]} esmc50\_domain{[}N\_hom\_ddi\_hh \textgreater{} 0,
table(N\_hom\_ddi\_hh\_exc == 0), by = ``type''{]}
fisher.test(matrix(esmc50\_domain{[}N\_hom\_ddi\_hh \textgreater{} 0,
table(N\_hom\_ddi\_hh\_exc == 0), by = ``type''{]}{[}, V1{]}, ncol = 2))

ddi\_hh\_exc\_tab = esmc50\_domain{[}N\_hom\_ddi\_hh \textgreater{} 0,
as.integer(table(N\_hom\_ddi\_hh\_exc == 0)), by = ``type''{]}
setnames(ddi\_hh\_exc\_tab, ``V1'', ``prop'') ddi\_hh\_exc\_tab{[},
``contain eukaryotic-like domains that'' := rep(c(``mediate PPIs
exclusively in eukaryotes'', ``also mediate DDIs in bacteria''), 2){]}
ddi\_hh\_exc\_tab{[}, lab\_pos := cumsum(prop) - 0.5 * prop, by =
``type''{]}

ggplot(ddi\_hh\_exc\_tab{[}type == ``Effector''{]}, aes(x = 2, y = prop,
fill = \texttt{contain\ eukaryotic-like\ domains\ that})) +
geom\_bar(stat = ``identity'', color = ``white'') + coord\_polar(theta =
``y'', start = 0) + geom\_text(aes(y = lab\_pos, label = prop), color =
``white'', size = 10) + scale\_fill\_manual(values = c(``cyan'',
``blue'')) + theme\_void() + xlim(0.5, 2.5)

ggplot(ddi\_hh\_exc\_tab{[}type == ``Non-effector''{]}, aes(x = 2, y =
prop, fill = \texttt{contain\ eukaryotic-like\ domains\ that})) +
geom\_bar(stat = ``identity'', color = ``white'') + coord\_polar(theta =
``y'', start = 0) + geom\_text(aes(y = lab\_pos, label = prop), color =
``white'', size = 10) + scale\_fill\_manual(values = c(``cyan'',
``blue'')) + theme\_void() + xlim(0.5, 2.5)

nodes = fread(``database/taxonomy/nodes.tab'', header = FALSE,
colClasses = ``character'') names(nodes){[}1:3{]} = c(``taxid'',
``parenttaxid'', ``taxrank'') rankedlineage =
fread(``database/taxonomy/rankedlineage.tab'', header = FALSE,
colClasses = ``character'') setnames(rankedlineage, c(``taxid'',
``taxname'', ``species'', ``genus'', ``family'', ``order'', ``class'',
``phylum'', ``kingdom'', ``superkingdom'')) rankedlineage{[}, taxrank :=
nodes{[}match(rankedlineage\$taxid, taxid), taxrank{]}{]}
rankedlineage{[}nchar(species) == 0 \& taxrank == ``species'', species
:= taxname{]} rankedlineage{[}nchar(genus) == 0 \& taxrank == ``genus'',
genus := taxname{]} rankedlineage{[}nchar(family) == 0 \& taxrank ==
``family'', family := taxname{]} rankedlineage{[}nchar(order) == 0 \&
taxrank == ``order'', order := taxname{]} rankedlineage{[}nchar(class)
== 0 \& taxrank == ``class'', class := taxname{]}
rankedlineage{[}nchar(phylum) == 0 \& taxrank == ``phylum'', phylum :=
taxname{]}

esmc50\_domain\_speciesids = rankedlineage{[}species \%in\%
esmc50\_domain\$species \& taxrank == ``species'', unique(taxid){]}

effector\_hom\_ddi\_hh\_exc = esmc50\_domain{[}type == ``Effector'' \&
N\_hom\_ddi\_hh\_exc \textgreater{} 0, .(uniprotac, species, pfam,
pfam\_hom\_ddi\_hh\_exc){]} \# effector domains mediating PPIs
exclusively in eukaryotes in host-endogenous PPIs, also identified from
experimental host-pathogen PPIs esmc50\_domain{[}type == ``Effector'' \&
N\_hom\_ddi\_hh\_exc \textgreater{} 0,
intersect(unlist(strsplit(pfam\_hom\_ddi\_hh\_exc, ``;'')),
div\_evol\$\texttt{Horizontally-acquired\ host\ domain}){]} \# effector
domains mediating PPIs exclusively in eukaryotes in host-endogenous
PPIs, but not identified from experimental host-pathogen PPIs
esmc50\_domain{[}type == ``Effector'' \& N\_hom\_ddi\_hh\_exc
\textgreater{} 0, setdiff(unlist(strsplit(pfam\_hom\_ddi\_hh\_exc,
``;'')), div\_evol\$\texttt{Horizontally-acquired\ host\ domain}){]}
effector\_hom\_ddi\_hh\_exc{[}, pfam := gsub(``;'', ``;'', pfam){]}
effector\_hom\_ddi\_hh\_exc{[}, pfam\_speciesids\_patho := \{x =
unlist(strsplit(pfam, ``;'')); paste0(Reduce(intersect, lapply(x,
function(y) pfam2proteome\_bacteria{[}pfam == y,
unlist(strsplit(bacteria\_speciesids\_patho, ``;'')){]})), collapse =
``;'')\}, by = ``pfam''{]} effector\_hom\_ddi\_hh\_exc{[},
pfam\_speciesids\_patho := paste0(intersect(esmc50\_domain\_speciesids,
unlist(strsplit(pfam\_speciesids\_patho, ``;''))), collapse = ``;''), by
= ``pfam''{]} effector\_hom\_ddi\_hh\_exc{[}, N\_pfam\_speciesids\_patho
:= str\_count(pfam\_speciesids\_patho, ``;'') + 1{]}
effector\_hom\_ddi\_hh\_exc{[}, pfam\_speciesids\_patho := NULL{]}
effector\_hom\_ddi\_hh\_exc{[}, pfam\_hom\_ddi\_hh\_exc := gsub(``;'',
``;'', pfam\_hom\_ddi\_hh\_exc){]} setorder(effector\_hom\_ddi\_hh\_exc,
pfam\_hom\_ddi\_hh\_exc) setcolorder(effector\_hom\_ddi\_hh\_exc,
c(``uniprotac'', ``species'', ``pfam'', ``N\_pfam\_speciesids\_patho'',
``pfam\_hom\_ddi\_hh\_exc'')) setnames(effector\_hom\_ddi\_hh\_exc,
c(``UniProt Accession'', ``Representative species'', ``Domains'', ``\#
Pathogenic spp. encoding proteins with domain(s)'', ``Domains mediating
PPIs exclusively in eukaryotes''))
write.csv(effector\_hom\_ddi\_hh\_exc, ``figs\_tabs/Table 1.csv'', quote
= FALSE, row.names = FALSE)

\hypertarget{divergent-evolution-in-host-endogenous-ppi-network-vs.-convergent-evolution-in-host-bacteria-ppi-network}{%
\section{divergent evolution in host-endogenous PPI network
vs.~convergent evolution in host-bacteria PPI
network}\label{divergent-evolution-in-host-endogenous-ppi-network-vs.-convergent-evolution-in-host-bacteria-ppi-network}}

domain\_usage = ddi\_hh\_exc\_tab domain\_usage{[}, type :=
rep(c(``host-endogenous PPI network'', ``host-bacteria PPI network''),
each = 2){]} domain\_usage{[}, prop := c(length(sdd\_hh), length(sd\_hh)
- length(sdd\_hh), length(sdd\_bh), length(sd\_bh) - length(sdd\_bh)){]}
names(domain\_usage){[}3{]} = ``domains used by two proteins to
bind\nto the same domain of a common target'' domain\_usage{[},
``domains used by two proteins to bind\nto the same domain of a common
target'' := rep(c(``same type'', ``different types''), length.out =
nrow(domain\_usage)){]} domain\_usage{[}, lab\_pos := cumsum(prop) - 0.5
* prop, by = ``type''{]}

ggplot(domain\_usage{[}type == ``host-endogenous PPI network''{]}, aes(x
= 2, y = prop, fill =
\texttt{domains\ used\ by\ two\ proteins\ to\ bind\textbackslash{}nto\ the\ same\ domain\ of\ a\ common\ target}))
+ geom\_bar(stat = ``identity'', color = ``white'') + coord\_polar(theta
= ``y'', start = 0) + geom\_text(aes(y = lab\_pos, label = prop), color
= ``white'', size = 10) + scale\_fill\_manual(values = c(``gray'',
``black'')) + theme\_void() + xlim(0.5, 2.5)

ggplot(domain\_usage{[}type == ``host-bacteria PPI network''{]}, aes(x =
2, y = prop, fill =
\texttt{domains\ used\ by\ two\ proteins\ to\ bind\textbackslash{}nto\ the\ same\ domain\ of\ a\ common\ target}))
+ geom\_bar(stat = ``identity'', color = ``white'') + coord\_polar(theta
= ``y'', start = 0) + geom\_text(aes(y = lab\_pos, label = prop), color
= ``white'', size = 10) + scale\_fill\_manual(values = c(``gray'',
``black'')) + theme\_void() + xlim(0.5, 2.5)

esmc\_mean\_h2b\_ddi\_hh = esmc50\_domain{[}N\_hom\_ddi\_hh
\textgreater{} N\_hom\_ddi\_hh\_exc, \{ i =
host\_bacteria\_ddi2species{[}dmA != dmB \& type != ``DDI'',
unique(unlist(lapply(intersect(unlist(strsplit(pfam, ``;'')),
setdiff(pfam\_ppi\_hh, pfam\_ppi\_hh\_exc)), grep, x =
domain\_pair))){]} j = host\_bacteria\_ddi2species{[}dmA == dmB \& type
!= ``DDI'', Reduce(intersect, list(unlist(strsplit(pfam, ``;'')), dmA,
setdiff(pfam\_ppi\_hh, pfam\_ppi\_hh\_exc))){]} h2b =
rbind(host\_bacteria\_ddi2species{[}dmA != dmB \& type !=
``DDI''{]}{[}i, .(host2bacteria\_ddi\_or,
host2bacteria\_ddi\_weight){]}, pfam2proteome\_host\_bacteria{[}pfam
\%in\% j, .(host2bacteria\_species\_or,
host2bacteria\_species\_weight){]}, use.names = FALSE) wmlor = h2b{[},
log(sum(host2bacteria\_ddi\_or * host2bacteria\_ddi\_weight) /
sum(host2bacteria\_ddi\_weight)){]} list(wmlor = wmlor)\}, by =
``uniprotid''{]} esmc\_mean\_h2b\_ddi\_hh{[}, wmlor := scale(wmlor,
scale = FALSE){]} esmc50\_domain{[}, mean\_h2b\_ddi\_hh :=
esmc\_mean\_h2b\_ddi\_hh{[}match(esmc50\_domain\$uniprotid, uniprotid),
wmlor{]}{]}

e1 = unique(esmc50\_domain{[}N\_hom\_ddi\_hh \textgreater{}
N\_hom\_ddi\_hh\_exc \& !is.na(mean\_h2b\_ddi\_hh){]}, by =
``mean\_h2b\_ddi\_hh'') e1{[}, table(type){]} ggplot(e1, aes(x = type, y
= mean\_h2b\_ddi\_hh, fill = type)) + geom\_violin(trim = TRUE) +
geom\_boxplot(width = 0.1) + labs(title = ``Bacterial proteins
containing domains that can mediate DDIs\nin both eukaryotes and
bacteria'', x = ``Type of bacterial protein'') + ylab(``Mean log-odds
ratio of component domain(s) co-occurring with interacting
domains\nin eukaryotes vs.~in bacteria'') e1{[},
mean(mean\_h2b\_ddi\_hh), by = ``type''{]} e1{[},
wilcox.test(mean\_h2b\_ddi\_hh \textasciitilde{} type){]}

effector\_hom\_ddi\_hh\_pri = e1{[}type == ``Effector''{]}
effector\_hom\_ddi\_hh\_pri{[}, pfam\_hom\_ddi\_hh\_bb :=
paste0(intersect(unlist(strsplit(pfam, ``;'')), setdiff(pfam\_ppi\_hh,
pfam\_ppi\_hh\_exc)), collapse = ``;''), by = ``uniprotid''{]}
effector\_hom\_ddi\_hh\_pri = effector\_hom\_ddi\_hh\_pri{[},
.(uniprotac, species, pfam, pfam\_hom\_ddi\_hh\_bb,
mean\_h2b\_ddi\_hh){]} effector\_hom\_ddi\_hh\_pri{[}, pfam :=
gsub(``;'', ``;'', pfam){]} effector\_hom\_ddi\_hh\_pri{[},
pfam\_speciesids\_patho := \{x = unlist(strsplit(pfam, ``;''));
paste0(Reduce(intersect, lapply(x, function(y)
pfam2proteome\_bacteria{[}pfam == y,
unlist(strsplit(bacteria\_speciesids\_patho, ``;'')){]})), collapse =
``;'')\}, by = ``pfam''{]} effector\_hom\_ddi\_hh\_pri{[},
pfam\_speciesids\_patho := paste0(intersect(esmc50\_domain\_speciesids,
unlist(strsplit(pfam\_speciesids\_patho, ``;''))), collapse = ``;''), by
= ``pfam''{]} effector\_hom\_ddi\_hh\_pri{[}, N\_pfam\_speciesids\_patho
:= str\_count(pfam\_speciesids\_patho, ``;'') + 1{]}
effector\_hom\_ddi\_hh\_pri{[}, pfam\_speciesids\_patho := NULL{]}
setorder(effector\_hom\_ddi\_hh\_pri, -mean\_h2b\_ddi\_hh)
effector\_hom\_ddi\_hh\_pri = effector\_hom\_ddi\_hh\_pri{[}1:10{]}
effector\_hom\_ddi\_hh\_pri{[}, mean\_h2b\_ddi\_hh :=
round(mean\_h2b\_ddi\_hh, 1){]} setcolorder(effector\_hom\_ddi\_hh\_pri,
c(``uniprotac'', ``species'', ``pfam'', ``pfam\_hom\_ddi\_hh\_bb'',
``N\_pfam\_speciesids\_patho'', ``mean\_h2b\_ddi\_hh''))
setnames(effector\_hom\_ddi\_hh\_pri, c(``UniProt Accession'',
``Species'', ``Domains'', ``Domains with DDI partners in both eukaryotes
and bacteria'', ``\# Pathogenic spp. encoding proteins with domain(s)'',
``Log odds ratio of domains co-occurring with DDI partners in eukaryotes
vs.~in bacteria'')) write.csv(effector\_hom\_ddi\_hh\_pri,
``figs\_tabs/Table 3.csv'', quote = FALSE, row.names = FALSE)

\hypertarget{non-interacting-eukaryotic-domains}{%
\subsubsection{Non-interacting eukaryotic
domains}\label{non-interacting-eukaryotic-domains}}

pfam\_ddi\_hh\_all =
host\_bacteria\_ddi2species{[}N\_host\_species\_pfams\_both
\textgreater{} 3, union(dmA, dmB){]} esmc50\_domain{[}N\_hom
\textgreater{} N\_hom\_ddi\_hh, mean\_h2b\_spp\_noddi\_hh :=
pfam2proteome\_host\_bacteria{[}pfam \%in\% .SD{[},
intersect(unlist(strsplit(pfam, ``;'')),
setdiff(pfam2proteome\_host\$pfam, pfam\_ddi\_hh\_all)){]},
log(sum(host2bacteria\_species\_or * host2bacteria\_species\_weight) /
sum(host2bacteria\_species\_weight)){]}, by = ``uniprotid''{]}
esmc50\_domain{[}N\_hom \textgreater{} N\_hom\_ddi\_hh,
mean\_h2b\_spp\_noddi\_hh := scale(mean\_h2b\_spp\_noddi\_hh, scale =
FALSE){]} esmc50\_domain{[}N\_hom \textgreater{} N\_hom\_ddi\_hh \&
!is.na(mean\_h2b\_spp\_noddi\_hh), table(type){]}

ggplot(esmc50\_domain{[}N\_hom \textgreater{} N\_hom\_ddi\_hh \&
!is.na(mean\_h2b\_spp\_noddi\_hh){]}, aes(x = type, y =
mean\_h2b\_spp\_noddi\_hh, fill = type)) + geom\_violin(trim = TRUE) +
geom\_boxplot(width = 0.1) + labs(title = ``Bacterial proteins
containing eukaryotic-like domains\nthat are unlikely to mediate DDIs in
eukaryotes'', x = ``Type of bacterial protein'') + ylab(``Mean log-odds
ratio of finding domain in host vs.~bacteria'') esmc50\_domain{[}N\_hom
\textgreater{} N\_hom\_ddi\_hh \& !is.na(mean\_h2b\_spp\_noddi\_hh),
mean(mean\_h2b\_spp\_noddi\_hh), by = ``type''{]}
esmc50\_domain{[}N\_hom \textgreater{} N\_hom\_ddi\_hh \&
!is.na(mean\_h2b\_spp\_noddi\_hh), wilcox.test(mean\_h2b\_spp\_noddi\_hh
\textasciitilde{} type){]}

\hypertarget{bacteria-exclusive-domain-hijacks-eukaryotic-domains-otherwise-exclusively-involved-in-eukaryotic-ddis}{%
\subsubsection{Bacteria-exclusive domain hijacks eukaryotic domains
otherwise exclusively involved in eukaryotic
DDIs}\label{bacteria-exclusive-domain-hijacks-eukaryotic-domains-otherwise-exclusively-involved-in-eukaryotic-ddis}}

pfam\_bacexc =
setdiff(pfam2proteome\_bacteria\(pfam, pfam2proteome_host\)pfam)
pfam\_bacexc\_ppi\_bh = ddi\_bh{[}dmA \%in\% pfam\_ppi\_hh,
intersect(pfam\_bacexc, dmB){]} pfam\_bacexc\_ppi\_bh\_hh\_exc =
ddi\_bh{[}dmA \%in\% pfam\_ppi\_hh\_exc, intersect(pfam\_bacexc, dmB){]}

\hypertarget{all-prokaryotic-domains-with-the-potential-to-target-eukaryotic-domains}{%
\section{all prokaryotic domains with the potential to target eukaryotic
domains}\label{all-prokaryotic-domains-with-the-potential-to-target-eukaryotic-domains}}

pfam\_bacexc\_ddi\_bh = union(host\_bacteria\_ddi2species{[}type \%in\%
c(``ppi'', ``interprotein'') \& dmA \%in\% pfam\_bacexc \& dmB \%in\%
pfam\_ppi\_hh, dmA{]}, host\_bacteria\_ddi2species{[}type \%in\%
c(``ppi'', ``interprotein'') \& dmB \%in\% pfam\_bacexc \& dmA \%in\%
pfam\_ppi\_hh, dmB{]})

pfam\_bacexc\_ddi\_bh\_hh\_exc =
union(host\_bacteria\_ddi2species{[}type \%in\% c(``ppi'',
``interprotein'') \& dmA \%in\% pfam\_bacexc \& dmB \%in\%
pfam\_ppi\_hh\_exc, dmA{]}, host\_bacteria\_ddi2species{[}type \%in\%
c(``ppi'', ``interprotein'') \& dmB \%in\% pfam\_bacexc \& dmA \%in\%
pfam\_ppi\_hh\_exc, dmB{]})

esmc50\_domain{[}N\_hom == 0, N\_bacexc\_ddi\_bh :=
sum(unlist(strsplit(pfam, ``;'')) \%in\% c(pfam\_bacexc\_ppi\_bh,
pfam\_bacexc\_ddi\_bh)), by = ``uniprotid''{]} esmc50\_domain{[}N\_hom
== 0 \& N\_bacexc\_ddi\_bh \textgreater{} 0, N\_bacexc\_ddi\_bh\_hh\_exc
:= sum(unlist(strsplit(pfam, ``;'')) \%in\%
c(pfam\_bacexc\_ppi\_bh\_hh\_exc, pfam\_bacexc\_ddi\_bh\_hh\_exc)), by =
``uniprotid''{]}

esmc50\_domain{[}N\_hom == 0, table(N\_bacexc\_ddi\_bh == 0), by =
``type''{]} esmc50\_domain{[}N\_hom == 0 \& N\_bacexc\_ddi\_bh
\textgreater{} 0, table(N\_bacexc\_ddi\_bh\_hh\_exc == 0), by =
``type''{]}

effector\_conv\_ddi\_hh\_exc = esmc50\_domain{[}N\_hom == 0 \&
N\_bacexc\_ddi\_bh\_hh\_exc \textgreater{} 0 \& type == ``Effector'',
.(uniprotid, species, pfam){]} effector\_conv\_ddi\_hh\_exc{[}, pb :=
paste0(sort(intersect(unlist(strsplit(pfam, ``;'')),
c(pfam\_bacexc\_ppi\_bh\_hh\_exc, pfam\_bacexc\_ddi\_bh\_hh\_exc))),
collapse = ``;''), by = ``uniprotid''{]}
effector\_conv\_ddi\_hh\_exc{[}, ph :=
paste0(sort(union(host\_bacteria\_ddi2species{[}type \%in\% c(``ppi'',
``interprotein'') \& dmA \%in\% unlist(strsplit(pb, ``;'')) \& dmB
\%in\% pfam\_ppi\_hh\_exc, dmB{]}, host\_bacteria\_ddi2species{[}type
\%in\% c(``ppi'', ``interprotein'') \& dmB \%in\% unlist(strsplit(pb,
``;'')) \& dmA \%in\% pfam\_ppi\_hh\_exc, dmA{]})), collapse = ``;''),
by = ``uniprotid''{]} effector\_conv\_ddi\_hh\_exc{[}, pfam :=
gsub(``;'', ``;'', pfam){]} setorder(effector\_conv\_ddi\_hh\_exc, ph,
pb) setnames(effector\_conv\_ddi\_hh\_exc, c(``UniProt Accession'',
``Species'', ``Domains'', ``Pathogen domains convergently targeting host
domains'', ``Targeted host domains involved in eukaryote-specific
PPIs'')) write.csv(effector\_conv\_ddi\_hh\_exc,
``figs\_tabs/Supplementary Table 3.csv'', quote = FALSE, row.names =
FALSE)

pfam\_bacexc\_ddi\_bh\_tab = esmc50\_domain{[}N\_hom == 0 \&
N\_bacexc\_ddi\_bh \textgreater{} 0,
as.integer(table(N\_bacexc\_ddi\_bh\_hh\_exc == 0)), by = ``type''{]}
setnames(pfam\_bacexc\_ddi\_bh\_tab, ``V1'', ``prop'')
pfam\_bacexc\_ddi\_bh\_tab{[}, ``contain bacteria-exclusive
domains\ntargeting eukaryotic domains that'' := rep(c(``mediate PPIs
exclusively in eukaryotes'', ``also mediate DDIs in bacteria''), 2){]}
pfam\_bacexc\_ddi\_bh\_tab{[}, lab\_pos := cumsum(prop) - 0.5 * prop, by
= ``type''{]}

ggplot(pfam\_bacexc\_ddi\_bh\_tab{[}type == ``Effector''{]}, aes(x = 2,
y = prop, fill =
\texttt{contain\ bacteria-exclusive\ domains\textbackslash{}ntargeting\ eukaryotic\ domains\ that}))
+ geom\_bar(stat = ``identity'', color = ``white'') + coord\_polar(theta
= ``y'', start = 0) + geom\_text(aes(y = lab\_pos, label = prop), color
= ``white'', size = 10) + scale\_fill\_manual(values = c(``pink'',
``red'')) + theme\_void() + xlim(0.5, 2.5)

ggplot(pfam\_bacexc\_ddi\_bh\_tab{[}type == ``Non-effector''{]}, aes(x =
2, y = prop, fill =
\texttt{contain\ bacteria-exclusive\ domains\textbackslash{}ntargeting\ eukaryotic\ domains\ that}))
+ geom\_bar(stat = ``identity'', color = ``white'') + coord\_polar(theta
= ``y'', start = 0) + geom\_text(aes(y = lab\_pos, label = prop), color
= ``white'', size = 10) + scale\_fill\_manual(values = c(``pink'',
``red'')) + theme\_void() + xlim(0.5, 2.5)

\end{document}
